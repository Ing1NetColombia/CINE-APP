<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Horarios y Tarifas</title>
    <link rel="stylesheet" href="../../css/bootstrap.min.css" />
    <link rel="stylesheet" href="../../css/estilos.css" />
  </head>
  <body>
    <div class="container fondoblanco">
      <div class="dropdown">
        <button
          class="btn btn-secondary dropdown-toggle"
          type="button"
          id="dropdownMenu2"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          Configuración
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu2">
          <li>
            <a class="dropdown-item" href="/assets/Menu/peliculas/pelicula.html"
              >Peliculas</a
            >
          </li>
          <li>
            <a class="dropdown-item" href="/assets/Menu/confites/confites.html"
              >Confiteria</a
            >
          </li>
          <li>
            <a class="dropdown-item" href="/assets/Menu/horarios/horario.html"
              >Horarios y Tarifas</a
            >
          </li>
          <li><a class="dropdown-item" href="/index.html">Salir</a></li>
        </ul>
      </div>

      <div class="row">
        <div class="col-1"></div>
        <div class="col-3">
          <h1 class="offset-3">Horarios y Tarifas</h1>

          <form action="" id="frmhora">
            <label for="Orden">Orden </label>
            <input
              type="number"
              id="orden"
              name="Orden"
              class="form-control"
              min="0"
            />

            <label for="Fecha">Fecha</label>
            <input type="date" id="fecha" name="Fecha" class="form-control" />

            <label for="Inicio">Inicio</label>
            <input type="time" id="inicio" name="Inicio" class="form-control" />

            <label for="Fin">Fin</label>
            <input type="time" id="fin" name="Fin" class="form-control" />

            <label for="Tarifa">Tarifa</label>
            <input
              type="number"
              id="tarifa"
              name="Tarifa"
              class="form-control"
            />

            <div class="col-2 offset-5 my-5">
              <input
                type="button"
                class="btn btn-success"
                onclick="guardarHorario()"
                value="Guardar"
              />
            </div>
          </form>
        </div>
        <div class="col-2"></div>
        <div class="col-5">
          <table class="table table-striped table-hover">
            <thead class="justify-content-center">
              <th>Orden</th>
              <th>Fecha</th>
              <th>Inicio</th>
              <th>Fin</th>
              <th>Tarifa</th>
            </thead>
            <tbody id="tbl_horario"></tbody>
          </table>
        </div>
        <div class="col-1"></div>
      </div>
      <br>
    </div>

    <div class="container fondoblanco">
      <footer>
        <div class="mt-3">
          <hr>
        </div>
          <div class="m-1 d-flex justify-content-center">
            </div>
            <div class="m-1">
              <p class="d-flex justify-content-center m-1">
                Copyright© 2023 todos los derechos reservados
              </p>
              <p class="d-flex justify-content-center">       
                Cine Films ® SAS.
              </p>
              <hr>
            </div>
      </footer>
    </div>

    <script src="../../js/bootstrap.bundle.min.js"></script>

    <script>
      leerHorario();

      function guardarHorario() {
        var horarios = JSON.parse(localStorage.getItem("horariog")) || []; //Obtiene los horarios ya guardados, si no sobreescribe en el localstorage

        var objOrden = document.getElementById("orden");
        var objFecha = document.getElementById("fecha");
        var objHoraInicio = document.getElementById("inicio");
        var objHoraFinal = document.getElementById("fin");
        var objTarifa = document.getElementById("tarifa");

        var orden = objOrden.value;
        var fecha = objFecha.value;
        var horaInicio = objHoraInicio.value;
        var horaFinal = objHoraFinal.value;
        var tarifa = objTarifa.value;

        var horario = {
          Orden: orden,
          Fecha: fecha,
          HoraInicio: horaInicio,
          HoraFinal: horaFinal,
          Tarifa: tarifa,
        };

        horarios.push(horario);

        localStorage.setItem("horariog", JSON.stringify(horarios)); //envia al localstorage

        leerHorario();

        document.getElementById("frmhora").reset(); //limpiar formularios despues de grabar
      }

      function leerHorario() {
        var horarios = JSON.parse(localStorage.getItem("horariog")) || [];

        var tbl_horario2 = document.getElementById("tbl_horario");

        tbl_horario2.innerHTML = ""; //hay que limpiar la tabla por que el foreach carga todos los horarios guardados en memoria
        horarios.forEach(function (horario) {
          //comillas invertidas para poder utilizar etiquetas html dentro de js
          var cadena = ` 
            <tr>
                <td>${horario["Orden"]}</td>
                <td>${horario["Fecha"]}</td>
                <td>${horario["HoraInicio"]}</td>
                <td>${horario["HoraFinal"]}</td>
                <td>${horario["Tarifa"]}</td>
            </tr>
            `;
          tbl_horario2.innerHTML += cadena;
        });
      }
    </script>
  </body>
</html>
