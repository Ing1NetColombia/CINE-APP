<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Horarios y Tarifas</title>
    <link rel="stylesheet" href="../css/bootstrap.min.css" />
    <link rel="stylesheet" href="../css/estilos.css" />
  </head>
  <body>
    <div class="card text-center colorbanda">
      <div class="card-header">
        <ul class="nav nav-tabs card-header-tabs">
          <li class="nav-item">
            <a class="nav-link" aria-current="true" href="../../index.html"
              >Inicio</a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/assets/horarios/horario.html"
              >Horarios</a
            >
          </li>
          <li class="nav-item">
            <a
              class="nav-link disabled"
              href="/assets/peliculas/pelicula.html"
              tabindex="-1"
              aria-disabled="true"
              >Peliculas</a
            >
          </li>
        </ul>
      </div>
      <div class="card-body">
        <h5 class="card-title">Special title treatment</h5>
        <p class="card-text">
          With supporting text below as a natural lead-in to additional content.
        </p>
        <a href="/assets/imagenes/peli1.jpg" class="btn btn-primary"
          >Go somewhere</a
        >
      </div>
    </div>
    <div class="row">
      <div class="col-1"></div>
      <div class="col-3" id="Form_horario">
        <h1 class="offset-3">Horarios y Tarifas</h1>

        <form action="" id="frmhora">
          <label for="Orden">Orden </label>
          <input
            type="number"
            id="orden"
            name="Orden"
            class="form-control"
            min="0"
          />

          <label for="Fecha">Fecha</label>
          <input type="date" id="fecha" name="Fecha" class="form-control" />

          <label for="Inicio">Inicio</label>
          <input type="time" id="inicio" name="Inicio" class="form-control" />

          <label for="Fin">Fin</label>
          <input type="time" id="fin" name="Fin" class="form-control" />

          <label for="Tarifa">Tarifa</label>
          <input type="number" id="tarifa" name="Tarifa" class="form-control" />

          <div class="col-2 offset-5 my-5">
            <input
              type="button"
              class="btn btn-success"
              onclick="guardarHorario()"
              value="Guardar"
            />
          </div>
        </form>
      </div>
      <div class="col-2"></div>
      <div class="col-5">
        <table class="table table-striped table-hover tblhorario">
          <thead class="justify-content-center">
            <th>Orden</th>
            <th>Fecha</th>
            <th>Inicio</th>
            <th>Fin</th>
            <th>Tarifa</th>
          </thead>
          <tbody id="tbl_horario"></tbody>
        </table>
      </div>
      <div class="col-1"></div>
    </div>

    <script src="../js/bootstrap.bundle.min.js"></script>

    <script>
      leerHorario();

      function guardarHorario() {

        var horarios = JSON.parse(localStorage.getItem("horariog")) || []; //Obtiene los horarios ya guardados, si no sobreescribe en el localstorage
        
        var objOrden = document.getElementById("orden");
        var objFecha = document.getElementById("fecha");
        var objHoraInicio = document.getElementById("inicio");
        var objHoraFinal = document.getElementById("fin");
        var objTarifa = document.getElementById("tarifa");

        var orden = objOrden.value;
        var fecha = objFecha.value;
        var horaInicio = objHoraInicio.value;
        var horaFinal = objHoraFinal.value;
        var tarifa = objTarifa.value;

        var horario = {
          Orden: orden,
          Fecha: fecha,
          HoraInicio: horaInicio,
          HoraFinal: horaFinal,
          Tarifa: tarifa,
        };

        horarios.push(horario);

        localStorage.setItem("horariog", JSON.stringify(horarios)); //envia al localstorage

        leerHorario();

        document.getElementById("frmhora").reset(); //limpiar formularios despues de grabar

      }

      function leerHorario() {
        var horarios = JSON.parse(localStorage.getItem("horariog")) || [];

        var tbl_horario2 = document.getElementById("tbl_horario");


        tbl_horario2.innerHTML = ""; //hay que limpiar la tabla por que el foreach carga todos los horarios guardados en memoria
        horarios.forEach(function (horario) { //comillas invertidas para poder utilizar etiquetas html dentro de js
          var cadena = ` 
            <tr>
                <td>${horario["Orden"]}</td>
                <td>${horario["Fecha"]}</td>
                <td>${horario["HoraInicio"]}</td>
                <td>${horario["HoraFinal"]}</td>
                <td>${horario["Tarifa"]}</td>
            </tr>
            `;
          tbl_horario2.innerHTML += cadena;
        });
      }
    </script>
  </body>
</html>
